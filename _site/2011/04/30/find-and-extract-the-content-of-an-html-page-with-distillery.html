<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Find and extract the content portion of an HTML document with Distillery - bitfluxx.com</title>
    
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" />
    <link href="/stylesheets/print.css" media="print" rel="stylesheet" />
    <link href="/stylesheets/syntax.css" media="screen, projection" rel="stylesheet" />
    <!--[if IE]>
    <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <![endif]-->
  </head>
  
  <body id="blog">
    
    <header id="sitewide">
      <div id="name"><h1><a href="/">bitfluxx</a></h1></div>
      <nav>
        <ul>
          <li id="blog-link"><a href="/blog.html">Blog</a></li>
          <li id="projects-link"><a href="/projects.html">Projects</a></li>
          <li id="about-link"><a href="/about.html">About</a></li>
        </ul>
      </nav>
    </header>
    
    <section id="content"><article class="post">
  <header>
    <h1>Find and extract the content portion of an HTML document with Distillery</h1>
    <p><time datetime="" pubdate>Written 30 Apr 2011</time></p>
  </header>

  <section>
    <p>I just open-sourced my latest project, <a href="https://github.com/Fluxx/distillery">Distillery</a>: a simple ruby gem that finds and extracts the &#8220;content&#8221; portion of an <span class="caps">HTML</span> document.  The algorithm is heavily influenced by <a href="http://readability.com/">Readability</a>, who were nice enough to make <a href="http://code.google.com/p/arc90labs-readability/source/browse/trunk/js/readability.js">their logic</a> open source.  In fact, the algorithm in Distillery to find the content element is nearly identical to that of Readability.  However, while Readability&#8217;s algorithm aggressively cleans the content element <span class="caps">HTML</span> for display and online reading, Distillery allows the user to choose how (and if) they would like to clean content element <span class="caps">HTML</span>.</p>
<p>Usage of Distillery quite simple:</p>
<div class="highlight"><pre><code class="ruby"><span class="no">Distillery</span><span class="o">.</span><span class="n">distill</span><span class="p">(</span><span class="n">html_doc_as_a_string</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="s2">&quot;distilled content&quot;</span>
</code></pre>
</div><p>By default Distillery will clean the <span class="caps">HTML</span> of the content element for you.  This usually removes things like advertisements, widgets, etc.  If you don&#8217;t want to clean the <span class="caps">HTML</span> of the content element, you can pass <code>:clean =&gt; false</code> as an option to the <code>distill</code> method:</p>
<div class="highlight"><pre><code class="ruby"><span class="no">Distillery</span><span class="o">.</span><span class="n">distill</span><span class="p">(</span><span class="n">html_doc_as_a_string</span><span class="p">,</span> <span class="ss">:clean</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="s2">&quot;raw distilled content&quot;</span>
</code></pre>
</div><p>Right now the only control over cleaning the content <span class="caps">HTML</span> you have is whether to clean it, or not.  But there are a lot of levers and options in the cleaning code that I plan on adding to the public <span class="caps">API</span> to allow users of the gem to clean the content <span class="caps">HTML</span> exactly as they need to.</p>
<p>Distillery also comes with a <code>distill</code> executable that lets you distill content at the command line and print it to standard out:</p>
<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>distill http://bitfluxx.com/2011/02/22/rspec-encoding-matchers-for-ruby-1-9.html
&lt;header&gt;&lt;h1&gt;Rspec Encoding Matchers <span class="k">for </span>Ruby 1.9&lt;/h1&gt;
&lt;p&gt;&lt;<span class="nb">time </span><span class="nv">datetime</span><span class="o">=</span><span class="s2">&quot;&quot;</span> pubdate&gt;Written 22 Feb 2011&lt;/time&gt;&lt;/p&gt;
<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div><p>For more details on Distillery, please see the <a href="https://github.com/Fluxx/distillery">Readme</a> or the <a href="http://rubydoc.info/gems/distillery/0.1.0/frames">RDocs</a>.</p>
  </section>

  
  <section id="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'bitfluxx';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </section>
  
</article></section>

    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
    <script type="text/javascript">
      _uacct = "UA-3372951-1";
      urchinTracker();
    </script>
  </body>
</html>